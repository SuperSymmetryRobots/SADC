<!-- -->
<launch>

  <arg name="demo" default="seat_car"/>
  <arg name="gazebo_gui" default="True"/>
  <arg name="car_x"    default="0.0"/>
  <arg name="car_y"    default="0.0"/>
  <arg name="car_yaw"  default="0.0"/>

  <include file="$(find seat_car_gazebo)/launch/seat_car_gazebo.launch">
    <arg name="demo" value="$(arg demo)"/>
    <arg name="gui"  value="$(arg gazebo_gui)"/>
    <arg name="x"    value="$(arg car_x)"/>
    <arg name="y"    value="$(arg car_y)"/>
    <arg name="yaw"  value="$(arg car_yaw)"/>
  </include>

  <include file="$(find seat_car_control)/launch/seat_car_control.launch"/>

  <node name="imu_filter"
        pkg="imu_filter_madgwick"
        type="imu_filter_node"
        output="screen">
    <remap from="/imu/data_raw"
             to="/imu"/>
    <param name="use_mag" value="false"/>
    <param name="gain" value="0.1"/>
    <param name="zeta" value="0.0"/>
    <param name="mag_bias_x" value="0.0"/>
    <param name="mag_bias_y" value="0.0"/>
    <param name="mag_bias_z" value="0.0"/>
    <param name="orientation_stddev" value="0.0"/>
    <param name="world_frame" value="nwu"/>
    <param name="use_magnetic_field_msg" value="false"/>
    <param name="fixed_frame" value="/seat_car/imu"/>
    <param name="publish_tf" value="false"/>
    <param name="reverse_tf" value="false"/>
    <param name="constant_dt" value="0.0"/>
    <param name="publish_debug_topics" value="false"/>
    <param name="stateless" value="false"/>
  </node>

  <!-- spawn road -->
  <!--
  <param name="road_description" command="$(find xacro)/xacro.py '$(find seat_car_description)/urdf/road_env.xacro'" />
  <node pkg="robot_state_publisher" type="state_publisher" name="road_tf_broadcaster">
    <param name="publish_frequency" type="double" value="50.0"/>
    <remap from="/joint_states" to="/road/joint_states" />
    <remap from="robot_description" to="road_description" />
  </node>
  
  <node name="spawn_road" pkg="gazebo_ros" type="spawn_model" args="-param road_description -urdf -model road -x 0 -y 0 -z 0.0 -R 0 -P 0 -Y 0 "/>
  
  <node name="road_tf" pkg="tf" type="static_transform_publisher"
        args="0 0 0 0 0 0 world road1_link 100"/>
  -->

  <node pkg="odometry" 
        type="odometry_publisher" 
        name="odometry_publisher"
        output="screen">
    <remap from="/motor_control/twist"
             to="/model_car/twist"/>
    <remap from="/model_car/yaw"
             to="/model_car/yaw"/>
  </node>

  <!--
  <include file="$(find seat_car_description)/launch/gps.launch"/>
  -->
  
  <node name="rviz"
        pkg="rviz"
        type="rviz"
        args="-d $(find seat_car_description)/config/seat_car.rviz" />

</launch>
